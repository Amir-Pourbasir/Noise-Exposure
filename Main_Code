import pandas as pd
import random

import pandas as pd
import random

# Load the "main.xlsx" file into a pandas DataFrame
amir_df = pd.read_excel("main.xlsx")

# Load the "random numbers.xlsx" file into a pandas DataFrame
random_numbers_df = pd.read_excel("random numbers.xlsx")

# Iterate through the random DMU numbers
for dmu_number in random_numbers_df['DMU Number']:
    # Check if the DMU number exists in the "main.xlsx" DataFrame
    if dmu_number in main_df['DMU Number'].values:
        # Find the index of the row with the matching DMU number
        index = main_df.index[main_df['DMU Number'] == dmu_number].tolist()[0]

        # Generate a random choice of -5 or 5 for the percentage change
        percentage_change = random.choice([-5, 5])

        # Iterate through columns B to I and apply the same percentage change
        for col in ['Input 1', 'Input 2', 'Input 3', 'Input 4', 'Input 5', 'Input 6', 'Input 7', 'Output']:
            current_value = main_df.at[index, col]

            # Calculate the new value with the same percentage change
            new_value = current_value * (1 + (percentage_change / 100))

            # Update the DataFrame with the new value
            main_df.at[index, col] = new_value

# Save the modified DataFrame to a new Excel file
amir_df.to_excel("main_modified.xlsx", index=False)
